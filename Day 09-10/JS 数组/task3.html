<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Task03</title>
  <style>
    body {
      background-color: rgb(212, 233, 236);
      text-align: center;
    }
  </style>
  <script>
    // å¯¹è±¡è½¬ä¸ºæ•°ç»„ï¼š
    var scoreObject = {
      "Tony": {
        "Math": 95,
        "English": 79,
        "Music": 68
      },
      "Simon": {
        "Math": 100,
        "English": 95,
        "Music": 98
      },
      "Annie": {
        "Math": 54,
        "English": 65,
        "Music": 88
      }
    }

    //å®ç°å¯¹è±¡è½¬æ¢ä¸ºæ•°ç»„
    function objToArr(obj) {
      var arr = []
      let entry = Object.entries(obj)
      // ç”¨for of loop 
      for (let [name, score] of entry) {
        score = Object.values(score)
        arr.push([name, ...score])
      }
      return arr;

      // ç”¨forEach loop 
      // arr = Object.entries(obj)
      // arr = arr.forEach((e, i, arr) => {
      //å–å‡ºåˆ†æ•°
      //   e[0] = Object.keys(obj)[1]
      //å–å‡ºåå­—
      //   e[1] = Object.values(e[1])
      // å–æ¶ˆåµŒå¥—
      //   e = e.flat();
      //   console.log(e);
      //   return arr;
      // })

    }
    // console.log(objToArr(scoreObject));
    let scoreArr = objToArr(scoreObject)

    // æ•°ç»„è½¬ä¸ºå¯¹è±¡
    // å®Œå…¨çœ‹ä¸æ‡‚ï¼è¿™é‡Œæ˜¯æŠ„å°é»„ç‹—çš„ğŸ˜­
    var menuArr = [
      [1, "Area1", -1],
      [2, "Area2", -1],
      [3, "Area1-1", 1],
      [4, "Area1-2", 1],
      [5, "Area2-1", 2],
      [6, "Area2-2", 2],
      [7, "Area1-2-3", 4],
      [8, "Area2-2-1", 6],
    ];

    function arrToObj(arr) {
      let obj = {};
      // å…ˆéƒ½å˜æˆobject
      for (let [order, name, preId] of arr) {
        obj[order] = {
          name: name,
          submenu: {},
          preId: preId
        }
      }

      // æ•´ç†objectå±‚æ¬¡ï¼Œç­›é€‰æ”¾åˆ°ä¸€ä¸ªæ–°çš„objecté‡Œé¢
      let menu = {}
      for (let order in obj) {
        //æŠŠæ¯ä¸€é¡¹éƒ½æå–å‡ºæ¥æ¯”è¾ƒ

        let id = order;
        //æå–èœå•å†…å®¹name/submenu
        let content = {
          name: obj[order].name,
          submenu: obj[order].submenu
        }
        let preId = obj[order].preId

        // æ’é™¤ç¬¬ä¸€å±‚çº§
        if (preId === -1) {
          menu[id] = content
        } else {
          // ç»™ä¸‹é¢å±‚çº§çš„menuèµ‹å€¼ï¼Œ
          // ä»ä¸‹å¾€ä¸Šå›æº¯,å…ˆç»™ä¸‹å±‚èœå•èµ‹å€¼ submenu[id]=content 
          // å› ä¸ºç¬¬ä¸‰ä¸ªæ•°å­—(preid)æ˜¯ä¸Šçº§èœå•çš„ç¬¬ä¸€ä¸ªæ•°å­—(order)æ‰€ä»¥ç”¨obj[preId].é™„åŠ åˆ°ä¸Šå±‚èœå•ä¸­
          obj[preId].submenu[id] = content
        }
      }
      return menu
    }

    // å‚è€ƒï¼šå°é»„ç‹— https://github.com/e-han-cyber/baidu-frontend-prictice/blob/main/day09-10/js/task3.js
    // å®ç°æ•°ç»„è½¬æ¢ä¸ºå¯¹è±¡
    // function arrToObj(arr) {
    //   let obj = {};
    //   let map = {}
    //   for (let a of arr) {
    //     let id = a[0];
    //     let sub = a[2];
    //     // ä½¿ç”¨ pid è®°å½•ä¸Šä¸€çº§èœå•
    //     map[id] = { name: a[1], pid: sub, submenu: {} }
    //   }
    //   for (let key in map) {
    //     let id = key;
    //     let item = map[key];
    //     let subid = map[key].pid;

    //     if (subid === -1) {
    //       obj[id] = item
    //       delete item.pid
    //     } else {
    //       //subid æ­£å¥½å¯¹åº”è¦å­˜çš„ id çš„å¯¹è±¡
    //       map[subid].submenu[id] = item;
    //       delete item.pid
    //     }
    //   }
    //   return obj
    console.log(arrToObj(menuArr));
    let menuObject = arrToObj(menuArr)
  </script>
</head>

<body>
  <h1>JavaScript Day09-10 æ•°ç»„</h1>
</body>

</html>